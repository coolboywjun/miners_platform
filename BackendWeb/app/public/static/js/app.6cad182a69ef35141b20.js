webpackJsonp([1],{"+ELY":function(t,e){},"+Tkp":function(t,e){},Dj6R:function(t,e){},IzLJ:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+uW"),n=a("zL8q"),s=a.n(n),r=(a("Qbok"),a("tvR6"),{render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"clearfix",staticStyle:{height:"52px"}},[t._m(0),t._v(" "),a("nav",{staticClass:"fr"},[a("ul",{staticClass:"clearfix"},[a("li",{staticClass:"fl nav-item"},[a("a",{staticClass:"link-btn",class:{active:t.isActive("Home")},on:{click:t.home}},[t._v("首页")])]),t._v(" "),a("li",{staticClass:"fl nav-item"},[a("a",{staticClass:"link-btn",class:{active:t.isActive("BatchConfiguration")},on:{click:t.batchConfiguration}},[t._v("批量配置")])]),t._v(" "),t._m(1),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"fl logo"},[e("img",{attrs:{src:"static/logo.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"fl nav-item"},[e("a",{staticClass:"link-btn"},[this._v("登录")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"fl nav-item"},[e("a",{staticClass:"link-btn"},[this._v("注册")])])}]});var o=a("VU/8")({methods:{isActive:function(t){return this.$route.name===t},home:function(){this.$router.push("/")},batchConfiguration:function(){this.$router.push("/batch-configuration")}}},r,!1,function(t){a("xIhB")},"data-v-4abaa192",null).exports,l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.notHome?a("el-breadcrumb",{attrs:{separator:"/"}},[t.notHome?a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]):t._e(),t._v(" "),t.isVisible("MinerDtail")?a("el-breadcrumb-item",[t._v("矿机详情")]):t._e(),t._v(" "),t.isVisible("BatchConfiguration")?a("el-breadcrumb-item",[t._v("批量配置")]):t._e()],1):t._e()},staticRenderFns:[]};var c=a("VU/8")({computed:{notHome:function(){return"Home"!==this.$route.name}},methods:{isVisible:function(t){return this.$route.name===t}}},l,!1,function(t){a("tn30")},null,null).exports,u={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("p",[this._v("慧智矿机管理平台 Miners Platform v1.0")]),this._v(" "),e("p",[this._v("© 2018 深圳慧智科技有限公司版权所有")])])}]};var p={name:"App",components:{TopHeader:o,BottomFooter:a("VU/8")({},u,!1,function(t){a("agvb")},"data-v-9255c344",null).exports,TopNavigation:c}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",{attrs:{id:"app"}},[e("el-header",{staticClass:"wrap bg-header",staticStyle:{height:"52px"}},[e("top-header",{staticClass:"innerwrap"})],1),this._v(" "),e("div",{staticClass:"wrap"},[e("top-navigation",{staticClass:"innerwrap top-navigation"})],1),this._v(" "),e("el-main",{staticClass:"wrap"},[e("div",{staticClass:"innerwrap"},[e("router-view")],1)]),this._v(" "),e("el-footer",{staticClass:"wrap"},[e("bottom-footer",{staticClass:"innerwrap"})],1)],1)},staticRenderFns:[]};var h=a("VU/8")(p,d,!1,function(t){a("g7tb")},"data-v-7f847750",null).exports,m=a("/ocq"),f=a("vy4U"),v=a.n(f),b={props:{number:{type:Number,default:0},precision:0},data:function(){return{tweenedNumber:0,tween:null}},computed:{animatedNumber:function(){return this.tweenedNumber.toFixed(this.precision)}},watch:{number:function(t,e){var a=this;this.tween=new v.a.Tween({number:e}),this.tween.to({number:t},500).onUpdate(function(){a.tweenedNumber=this.number}),this.tween.start()}},created:function(){requestAnimationFrame(function t(e){requestAnimationFrame(t),v.a.update(e)})}},_={render:function(){var t=this.$createElement;return(this._self._c||t)("span",{staticClass:"fz-number-large",domProps:{textContent:this._s(this.animatedNumber)}})},staticRenderFns:[]},w=a("VU/8")(b,_,!1,null,null,null).exports,y=a("woOf"),g=a.n(y),x=a("XLwt"),k=a.n(x);var C={exportPic:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"spline",a=t.getConnectedDataURL({type:"png",backgroundColor:"#fff",pixelRatio:1,excludeComponents:["toolbox"]}),i=document.createElement("a");i.download=e+".png",i.target="_blank",i.href=a;var n,s,r,o=(n={},s=navigator.userAgent.toLowerCase(),(r={edge:/edge\/([\d.]+)/,rv:/rv:([\d.]+)\) like gecko/,msie:/msie ([\d.]+)/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/}).edge.test(s)?n.edge=s.match(r.edge)[1]:r.rv.test(s)?n.ie=s.match(r.rv)[1]:r.msie.test(s)?n.ie=s.match(r.msie)[1]:r.firefox.test(s)?n.firefox=s.match(r.firefox)[1]:r.chrome.test(s)?n.chrome=s.match(r.chrome)[1]:r.opera.test(s)?n.opera=s.match(r.opera)[1]:r.safari.test(s)&&(n.safari=s.match(r.safari)[1]),n.edge?{broswer:"Edge",version:n.edge}:n.ie?{broswer:"IE",version:n.ie}:n.firefox?{broswer:"Firefox",version:n.firefox}:n.chrome?{broswer:"Chrome",version:n.chrome}:n.opera?{broswer:"Opera",version:n.opera}:n.safari?{broswer:"Safari",version:n.safari}:{broswer:"",version:"0"});if("function"==typeof MouseEvent&&"IE"!==o.browser&&"Edge"!==o.browser){console.log(o);var l=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});i.dispatchEvent(l)}else if(window.navigator.msSaveOrOpenBlob){for(var c=atob(a.split(",")[1]),u=c.length,p=new Uint8Array(u);u--;)p[u]=c.charCodeAt(u);var d=new Blob([p]);window.navigator.msSaveOrOpenBlob(d,"hashrate-spline.png")}else{var h='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="右键另存为图片" /></body>';window.open().document.write(h)}}},E={name:"HashrateSpline",props:{hashrateList:{default:function(){return{day:[],week:[],month:[],season:[],half:[],year:[]}}},title:""},data:function(){return{filterKey:"day",myChart:null,unit:"MH/S"}},methods:{btnTypeBy:function(t){return t===this.filterKey?"primary":""},filter:function(t){this.filterKey=t,this.$emit("switchTimeInterval",t)},pad0:function(t){return t<10?"0"+t:t},formatTime:function(t){var e=new Date(t);return e.getFullYear().toString()+"/"+(this.pad0(e.getMonth()+1)+"/")+(this.pad0(e.getDate())+" ")+(this.pad0(e.getHours())+":")+(this.pad0(e.getMinutes())+":")+this.pad0(e.getSeconds())},initData:function(t){var e=this,a={color:["#ffcd03","#675bba","#d14a61"],title:{show:!1},tooltip:{trigger:"axis",axisPointer:{animation:!1,lineStyle:{color:"#ffcd03"}},enterable:!1,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"#333",padding:7,textStyle:{fontSize:12,fontWeight:"lighter"},formatter:function(t){return e.formatTime(t[0].data[0])+"<br>\n算力: "+t[0].data[1].toFixed(2)}},grid:{left:"3%",right:"4%",bottom:"3%",top:"40",containLabel:!0},xAxis:{type:"time",splitLine:{show:!1},boundaryGap:!1,offset:10,axisLabel:{margin:2,textStyle:{color:"#888"}},axisLine:{lineStyle:{color:"#aaa"}}},yAxis:[{type:"value",name:"算力("+this.unit+")",position:"left",boundaryGap:!1,splitLine:{show:!1},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.05)"]}},axisLine:{lineStyle:{color:"#aaa"}},axisLabel:{formatter:"{value}",textStyle:{color:"#888"}}}],series:[{name:"算力",type:"line",smooth:!0,data:t,yAxisIndex:0,symbol:"emptyCircle",symbolSize:4,itemStyle:{color:"#ffcd03",borderWidth:1},lineStyle:{color:"#ffcd03",width:"2"},areaStyle:{color:new k.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#ffcd03"},{offset:1,color:"#fff"}])},emphasis:{itemStyle:{color:"#ffcd03"}}}]};this.myChart.setOption(a)},exportPic:function(){C.exportPic(this.myChart,"hashrate_spline")}},watch:{hashrateList:function(t){var e=g()({},t);e=e[this.filterKey];for(var a=0,i=0;i<e.length;i++)e[i][1]>a&&(a=e[i][1]);var n=this.$util.formatHashrate(1024*a*1024);this.unit=n.unit;for(var s=0;s<e.length;s++)e[s][1]=1024*e[s][1]*1024/n.totalRate;if(this.myChart){var r=this.myChart.getOption();r.yAxis[0].name="算力("+this.unit+")",r.series[0].data=e,this.myChart.setOption(r)}else this.myChart=k.a.init(document.getElementById("hashratespline-container")),this.initData(e)}},created:function(){},mounted:function(){}},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"chart-title",domProps:{textContent:t._s(t.title)}}),t._v(" "),a("div",{staticClass:"chart-select-time clearfix"},[a("el-button-group",[a("el-button",{attrs:{size:"small",type:t.btnTypeBy("day")},on:{click:function(e){t.filter("day")}}},[t._v("天")]),t._v(" "),a("el-button",{attrs:{size:"small",type:t.btnTypeBy("week")},on:{click:function(e){t.filter("week")}}},[t._v("周")]),t._v(" "),a("el-button",{attrs:{size:"small",type:t.btnTypeBy("month")},on:{click:function(e){t.filter("month")}}},[t._v("月")]),t._v(" "),a("el-button",{attrs:{size:"small",type:t.btnTypeBy("season")},on:{click:function(e){t.filter("season")}}},[t._v("季")]),t._v(" "),a("el-button",{attrs:{size:"small",type:t.btnTypeBy("half")},on:{click:function(e){t.filter("half")}}},[t._v("半年")]),t._v(" "),a("el-button",{attrs:{size:"small",type:t.btnTypeBy("year")},on:{click:function(e){t.filter("year")}}},[t._v("年")])],1),t._v(" "),a("div",{staticClass:"chart-toolBox fr"},[a("el-button",{attrs:{size:"small"},on:{click:t.exportPic}},[t._v("导出")])],1)],1),t._v(" "),t._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex-center"},[e("div",{staticClass:"flex-center echart-container",attrs:{id:"hashratespline-container"}})])}]};var P=a("VU/8")(E,I,!1,function(t){a("Dj6R")},"data-v-73d33309",null).exports,D={props:{tableData:{type:Array},pageSize:{type:Number,default:10},total:{type:Number,default:0}},data:function(){return{searchText:"",minerStatusMap:window.PublicKeys.minerStatus,select:"ip",currentPage:1}},computed:{searchQueryText:function(){return this.searchText?this.select+"="+this.searchText:""}},methods:{viewMiner:function(t,e){this.$router.push("/miner-detail?mac="+e)},search:function(){this.currentPage=1,this.$emit("search",this.searchQueryText)},reset:function(){this.searchText="",this.search()},exportTable:function(){console.log(this.tableData)},handleSizeChange:function(t){console.log("每页 "+t+" 条")},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentPage=t,this.$emit("handleCurrentChange",t,this.searchQueryText)}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"fl"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容"},model:{value:t.searchText,callback:function(e){t.searchText="string"==typeof e?e.trim():e},expression:"searchText"}},[a("el-select",{staticClass:"search-select",attrs:{slot:"prepend"},slot:"prepend",model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},[a("el-option",{attrs:{label:"IP",value:"ip"}}),t._v(" "),a("el-option",{attrs:{label:"位置",value:"position"}}),t._v(" "),a("el-option",{attrs:{label:"编号",value:"number"}}),t._v(" "),a("el-option",{attrs:{label:"状态",value:"status"}}),t._v(" "),a("el-option",{attrs:{label:"版本",value:"version"}})],1),t._v(" "),a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.search},slot:"append"})],1)],1),t._v(" "),a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:t.reset}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.exportTable}},[t._v("导出")])],1)]),t._v(" "),a("el-table",{staticClass:"mtl-table-container",attrs:{data:t.tableData,stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"型号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"version",label:"版本"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"number",label:"编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"position",label:"位置"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.viewMiner(e.row.ip,e.row.mac)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],staticClass:"mtl-pagination-container"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"page-count":11,layout:"prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var $={name:"Home",data:function(){return{mining:{mhs:0,total:0,normal:0,abnormal:0},errorTableData:[],fullTableData:[],errorMinerAmount:0,allMinerAmount:0,pageSize:50,fakeDatas:{},timerGetMining:null}},computed:{curHashrate:function(){return this.$util.formatHashrate(1024*this.mining.mhs*1024)}},components:{HashrateSpline:P,MinerTableList:a("VU/8")(D,S,!1,function(t){a("+Tkp")},null,null).exports,TweenNumber:w},methods:{getErrorMinerListBy:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i="/v1/miners/alerts?offset="+(t-1)*this.pageSize+"&size="+this.pageSize;a&&(i+="&"+a),this.$ajax.get(i).then(function(t){e.errorTableData=t.data.miners_alerts,e.errorMinerAmount=t.data.total})},getFullMinerListBy:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i="/v1/miners?offset="+(t-1)*this.pageSize+"&size="+this.pageSize;a&&(i+="&"+a),this.$ajax.get(i).then(function(t){console.log(t),e.fullTableData=t.data.miners,e.allMinerAmount=t.data.total})},searchError:function(t){this.getErrorMinerListBy(1,t)},searchFull:function(t){this.getFullMinerListBy(1,t)},handleErrorCurrentChange:function(t,e){this.getErrorMinerListBy(t,e)},handleAllCurrentChange:function(t,e){this.getFullMinerListBy(t,e)},getHashrateListBy:function(t){var e=this;this.$ajax.get("/v1/mining/mhs?period="+t).then(function(t){for(var a=t.data.mining_mhs,i=[],n=0;n<a.length;n++){var s=a[n];i.push([new Date(s.date).getTime(),s.mhs])}e.fakeDatas={day:i,week:i,month:i,season:i,half:i,year:i}})},getMiningInfo:function(){var t=this;this.$ajax.get("/v1/mining").then(function(e){t.mining=e.data.mining[0]})}},created:function(){var t=this;this.getMiningInfo(),this.timerGetMining=setInterval(function(){t.getMiningInfo()},5e3),this.getErrorMinerListBy(1,""),this.getFullMinerListBy(1,""),this.getHashrateListBy("day")},beforeDestroy:function(){clearInterval(this.timerGetMining)}},z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticClass:"mb",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"fl mr"},[t._v("当前算力:\n        "),a("tween-number",{attrs:{precision:2,number:Number(t.curHashrate.value)}}),t._v(" "),a("span",{domProps:{textContent:t._s(t.curHashrate.unit)}})],1),t._v(" "),a("div",{staticClass:"fl mr"},[t._v("矿机:\n        "),a("tween-number",{attrs:{number:t.mining.total}})],1),t._v(" "),a("div",{staticClass:"fl mr"},[t._v("正常:\n        "),a("tween-number",{attrs:{number:t.mining.normal}})],1),t._v(" "),a("div",[t._v("异常:\n        "),a("tween-number",{staticClass:"clr-danger",attrs:{number:t.mining.abnormal}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("div",{staticClass:"fl mr"},[t._v("温度:\n          "),a("tween-number",{attrs:{number:t.mining.temperature}})],1),t._v(" "),a("div",{staticClass:"fl"},[t._v("湿度:\n          "),a("tween-number",{attrs:{number:t.mining.humidity}})],1)])])],1),t._v(" "),a("el-row",{staticClass:"mb30 spline-wrap"},[a("hashrate-spline",{ref:"spline",attrs:{hashrateList:t.fakeDatas,title:"总算力图表"},on:{switchTimeInterval:t.getHashrateListBy}})],1),t._v(" "),a("el-row",[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"告警矿机"}},[a("miner-table-list",{attrs:{"table-data":t.errorTableData,"page-size":t.pageSize,total:t.errorMinerAmount},on:{search:t.searchError,handleCurrentChange:t.handleErrorCurrentChange}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"所有矿机"}},[a("miner-table-list",{attrs:{"table-data":t.fullTableData,"page-size":t.pageSize,total:t.allMinerAmount},on:{search:t.searchFull,handleCurrentChange:t.handleAllCurrentChange}})],1)],1)],1)],1)},staticRenderFns:[]};var N=a("VU/8")($,z,!1,function(t){a("oUCq")},"data-v-96a8ace0",null).exports,T={props:{tableData:{type:Array}},data:function(){return{minerStatusMap:window.PublicKeys.minerStatus,isEdit:!1,copy:null,loading:!1}},computed:{tableDataView:function(){return this.isEdit?[this.copy]:this.tableData}},methods:{editMiner:function(t){this.copy=g()({},this.tableData[0]),this.isEdit=!0},cancel:function(){this.isEdit=!1},save:function(t){var e=this,a=this.tableData[0].position&&this.copy.position.trim()===this.tableData[0].position.trim(),i=this.tableData[0].number&&this.copy.number.trim()===this.tableData[0].number.trim();if(a&&i)this.cancel();else{this.loading=!0;var n=this,s={patchAction:"setPosition",id:this.copy.id,ip:this.copy.ip,mac:this.copy.mac};if(a||(s.position=this.copy.position.trim()),i||(s.number=this.copy.number.trim()),!a&&i&&this.$ajax.patch("/v1/miner",s).then(function(t){e.$emit("refresh",function(){n.isEdit=!1,n.loading=!1})}).catch(function(t){alert(t),n.loading=!1}),!i&&a&&(s.patchAction="setNumber",this.$ajax.patch("/v1/miner",s).then(function(t){e.$emit("refresh",function(){n.isEdit=!1,n.loading=!1})}).catch(function(t){alert(t),n.loading=!1})),!i&&!a){var r=this;this.$ajax.all([this.$ajax.patch("/v1/miner",s),this.$ajax.patch("/v1/miner",g()({},s,{patchAction:"setNumber"}))]).then(this.$ajax.spread(function(t,e){r.$emit("refresh",function(){r.isEdit=!1,r.loading=!1})})).catch(function(t){alert(t),r.loading=!1})}}}}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableDataView,stripe:"","element-loading-text":"保存中"}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"型号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"version",label:"版本"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{prop:"number",label:"编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.number))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿机编号",size:"small"},model:{value:e.row.number,callback:function(a){t.$set(e.row,"number","string"==typeof a?a.trim():a)},expression:"scope.row.number"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"position",label:"位置"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.position))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿机位置",size:"small"},model:{value:e.row.position,callback:function(a){t.$set(e.row,"position","string"==typeof a?a.trim():a)},expression:"scope.row.position"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],attrs:{type:"text",size:"small"},on:{click:function(a){t.editMiner(e.row.id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"text",size:"small"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"text",size:"small"},on:{click:function(a){t.save(e.row.id)}}},[t._v("保存")])]}}])})],1)},staticRenderFns:[]};var A=a("VU/8")(T,L,!1,function(t){a("R+Ca")},"data-v-8adca2aa",null).exports,M={name:"TemperatureSpline",props:{temperatureList:{type:Array}},data:function(){return{myChart:null}},methods:{initData:function(){var t=this,e={color:["#df2639","#675bba","#d14a61"],tooltip:{trigger:"axis",axisPointer:{animation:!1,lineStyle:{color:"#df2639"}},enterable:!1,backgroundColor:"rgba(0,0,0,0.5)",borderColor:"#333",padding:7,textStyle:{fontSize:12,fontWeight:"lighter"},formatter:function(e){return t.$util.formatTime(e[0].data[0])+"<br>\n温度: "+e[0].data[1].toFixed(2)+" ℃"}},grid:{left:"3%",right:"4%",bottom:"3%",top:40,containLabel:!0},xAxis:{type:"time",splitLine:{show:!1},boundaryGap:!1,offset:10,axisLabel:{margin:2,textStyle:{color:"#888"}},axisLine:{lineStyle:{color:"#aaa"}}},yAxis:[{type:"value",name:"温度 (℃)",position:"left",boundaryGap:!1,splitLine:{show:!1},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.05)"]}},axisLine:{lineStyle:{color:"#aaa"}},axisLabel:{formatter:"{value}",textStyle:{color:"#888"}}}],series:[{name:"算力",type:"line",smooth:!0,data:this.temperatureList,yAxisIndex:0,symbol:"emptyCircle",symbolSize:4,itemStyle:{color:"#df2639"},lineStyle:{color:"#df2639",width:"2"},areaStyle:{color:new k.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#df2639"},{offset:1,color:"#fff"}])},emphasis:{itemStyle:{color:"#df2639"}}}]};this.myChart.setOption(e)},refreshData:function(t){if(!this.myChart)return this.myChart=k.a.init(document.getElementById("temperaturespline-container")),void this.initData();var e=this.myChart.getOption();e.series[0].data=t,this.myChart.setOption(e)},exportPic:function(){C.exportPic(this.myChart,"miner_temperature_spline")}},watch:{temperatureList:function(t){this.refreshData(t)}},mounted:function(){this.refreshData()}},B={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this._m(0),this._v(" "),e("div",{staticClass:"clearfix"},[e("div",{staticClass:"chart-toolBox fr"},[e("el-button",{attrs:{size:"small"},on:{click:this.exportPic}},[this._v("导出")])],1)]),this._v(" "),this._m(1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chart-title"},[this._v("矿机温度图表  当前温度:"),e("span",[this._v(" 24")]),e("span",{staticStyle:{"font-size":"14px"}},[this._v("℃")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex-center"},[e("div",{staticClass:"flex-center echart-container",attrs:{id:"temperaturespline-container"}})])}]};var H=a("VU/8")(M,B,!1,function(t){a("rpt/")},null,null).exports,F={name:"MinerBoard",props:{tableData:{type:Array}},data:function(){return{}},mounted:function(){}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mhs",label:"算力"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{domProps:{textContent:t._s(t.$util.formatHashrate(1024*(e.row.mhs||0)*1024).text)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"frequency",label:"频率"}}),t._v(" "),a("el-table-column",{attrs:{prop:"temperature",label:"温度"}}),t._v(" "),a("el-table-column",{attrs:{prop:"accept",label:"接收"}}),t._v(" "),a("el-table-column",{attrs:{prop:"reject",label:"拒绝"}})],1)},staticRenderFns:[]};var j=a("VU/8")(F,V,!1,function(t){a("ha/e")},null,null).exports,R={name:"MinerFan",props:{tableData:{type:Array}},data:function(){return{}},mounted:function(){}},U={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-table",{staticStyle:{width:"100%"},attrs:{data:this.tableData,stripe:""}},[e("el-table-column",{attrs:{type:"index"}}),this._v(" "),e("el-table-column",{attrs:{prop:"name",label:"名称"}}),this._v(" "),e("el-table-column",{attrs:{prop:"speed",label:"转速"}}),this._v(" "),e("el-table-column",{attrs:{prop:"status",label:"状态"}})],1)},staticRenderFns:[]};var q=a("VU/8")(R,U,!1,function(t){a("+ELY")},null,null).exports,O=a("mvHQ"),G=a.n(O),K={name:"MinerPool",props:{tableData:{type:Array}},data:function(){return{isEdit:!1,loading:!1,copy:null}},computed:{tableDataView:function(){return this.isEdit?this.copy:this.tableData}},methods:{edit:function(){this.copy=JSON.parse(G()(this.tableData)),this.isEdit=!0},cancel:function(){this.isEdit=!1},save:function(){var t=this;if(console.log("save"),G()(this.tableData)!==G()(this.copy)){this.loading=!0;var e=this;this.$ajax.patch("/v1/miner",{patchAction:"setPool",pool1_addr:this.copy[0].addr,pool1_miner_addr:this.copy[0].miner_addr,pool1_password:this.copy[0].password,pool2_addr:this.copy[1].addr,pool2_miner_addr:this.copy[1].miner_addr,pool2_password:this.copy[1].password,pool3_addr:this.copy[2].addr,pool3_miner_addr:this.copy[2].miner_addr,pool3_password:this.copy[2].password,mac:this.copy[0].mac}).then(function(a){"success"===a.data.result?t.$emit("refresh",function(){e.isEdit=!1,e.loading=!1}):(alert("保存失败"),e.loading=!1)}).catch(function(t){alert(t),e.loading=!1})}else this.cancel()}},mounted:function(){}},Q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"保存中"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDataView,stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{domProps:{textContent:t._s(e.row.name)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"400",prop:"addr",label:"矿池地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],domProps:{textContent:t._s(e.row.addr)}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿池地址",size:"small"},model:{value:e.row.addr,callback:function(a){t.$set(e.row,"addr","string"==typeof a?a.trim():a)},expression:"scope.row.addr"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",prop:"miner_addr",label:"矿工名"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],domProps:{textContent:t._s(e.row.miner_addr)}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿工名",size:"small"},model:{value:e.row.miner_addr,callback:function(a){t.$set(e.row,"miner_addr","string"==typeof a?a.trim():a)},expression:"scope.row.miner_addr"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",prop:"password",label:"密码"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],domProps:{textContent:t._s(e.row.password)}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入密码",size:"small"},model:{value:e.row.password,callback:function(a){t.$set(e.row,"password","string"==typeof a?a.trim():a)},expression:"scope.row.password"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"15px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],attrs:{type:"primary"},on:{click:t.edit}},[t._v("编辑")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)},staticRenderFns:[]},W=a("VU/8")(K,Q,!1,null,null,null).exports,J={name:"MinerNetwork",props:{tableData:{type:Array}},data:function(){return{isEdit:!1,copy:null,loading:!1,options:[{value:"dhcp",label:"dhcp"},{value:"static",label:"static"}]}},computed:{tableDataView:function(){return this.isEdit?[this.copy]:this.tableData}},methods:{edit:function(){this.copy=g()({},this.tableData[0]),this.isEdit=!0},cancel:function(){this.isEdit=!1},save:function(){var t=this;console.log("save");var e=this.$util.checkip;if("static"===this.copy.ip_type){if(!e(this.copy.ip))return void alert("请输入正确的 IP 地址");if(!e(this.copy.netmask))return void alert("请输入正确的 netmask");if(!e(this.copy.gateway))return void alert("请输入正确的 gateway");if(!e(this.copy.dns))return void alert("请输入正确的 dns")}this.loading=!0;var a=this;this.$ajax.patch("/v1/miner",{patchAction:"setNetwork",mac:this.copy.mac,ip_type:this.copy.ip_type,ip:this.copy.ip,netmask:this.copy.netmask,gateway:this.copy.gateway,dns:this.copy.dns}).then(function(e){"success"===e.data.result?t.$emit("refresh",function(){a.isEdit=!1,a.loading=!1}):(alert("保存失败"),a.loading=!1)}).catch(function(t){alert(t),a.loading=!1})}},mounted:function(){}},Y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableDataView,stripe:"","element-loading-text":"保存中"}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{width:"140",prop:"ip_type",label:"Protocol"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.ip_type))]),t._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],model:{value:e.row.ip_type,callback:function(a){t.$set(e.row,"ip_type","string"==typeof a?a.trim():a)},expression:"scope.row.ip_type"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.ip))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入ip地址",size:"small"},model:{value:e.row.ip,callback:function(a){t.$set(e.row,"ip","string"==typeof a?a.trim():a)},expression:"scope.row.ip"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"netmask",label:"Netmask"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.netmask))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入netmask",size:"small"},model:{value:e.row.netmask,callback:function(a){t.$set(e.row,"netmask","string"==typeof a?a.trim():a)},expression:"scope.row.netmask"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"gateway",label:"Gateway"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.gateway))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入gateway",size:"small"},model:{value:e.row.gateway,callback:function(a){t.$set(e.row,"gateway","string"==typeof a?a.trim():a)},expression:"scope.row.gateway"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"dns",label:"DNS"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}]},[t._v(t._s(e.row.dns))]),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入DNS server",size:"small"},model:{value:e.row.dns,callback:function(a){t.$set(e.row,"dns","string"==typeof a?a.trim():a)},expression:"scope.row.dns"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],attrs:{type:"text",size:"small"},on:{click:t.edit}},[t._v("编辑")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"text",size:"small"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"text",size:"small"},on:{click:t.save}},[t._v("保存")])]}}])})],1)},staticRenderFns:[]},X={name:"MinerDetail",data:function(){return{temperatureList:null,tableData:null,fakeDatas:null,timerInfo:null}},components:{MinerTable:A,HashrateSpline:P,TemperatureSpline:H,MinerBoard:j,MinerFan:q,MinerPool:W,MinerNetwork:a("VU/8")(J,Y,!1,null,null,null).exports},computed:{infoData:function(){var t={status:"",duration:"",curHashrate:"",avgHashrate:""};if(this.tableData&&this.tableData.length){var e=this.tableData[0];t.status=e.status,t.duration=this.$util.formatDuration(e.duration),t.curHashrate=this.$util.formatHashrate(1024*(e.mhs||0)*1024).text,t.avgHashrate=this.$util.formatHashrate(1024*(e.avg_mhs||0)*1024).text}return t},poolData:function(){var t=[];if(this.tableData&&this.tableData.length){var e=this.tableData[0],a={name:"pool1",addr:e.pool1_addr,miner_addr:e.pool1_miner_addr,password:e.pool1_password,status:e.pool1_status,mac:e.mac},i={name:"pool2",addr:e.pool2_addr,miner_addr:e.pool2_miner_addr,password:e.pool2_password,status:e.pool2_status,mac:e.mac},n={name:"pool3",addr:e.pool3_addr,miner_addr:e.pool3_miner_addr,password:e.pool3_password,status:e.pool3_status,mac:e.mac};t.push(a,i,n)}return t},fanData:function(){var t=[];if(this.tableData&&this.tableData.length){var e=this.tableData[0],a={name:"fan1",speed:e.fan1_speed,status:e.fan1_status},i={name:"fan2",speed:e.fan2_speed,status:e.fan2_status};t.push(a,i)}return t},boardData:function(){var t=[];if(this.tableData&&this.tableData.length){var e=this.tableData[0],a={name:"board1",accept:e.board1_accept,frequency:e.board1_frequency,mhs:e.board1_mhs,reject:e.board1_reject,temperature:e.board1_temperate},i={name:"board2",accept:e.board2_accept,frequency:e.board2_frequency,mhs:e.board2_mhs,reject:e.board2_reject,temperature:e.board2_temperate},n={name:"board3",accept:e.board3_accept,frequency:e.board3_frequency,mhs:e.board3_mhs,reject:e.board3_reject,temperature:e.board3_temperate},s={name:"board4",accept:e.board4_accept,frequency:e.board4_frequency,mhs:e.board4_mhs,reject:e.board4_reject,temperature:e.board4_temperate};t.push(a,i,n,s)}return t}},methods:{fetchData:function(){var t=this,e=this.$route.query.mac;this.$ajax.get("/v1/miner?mac="+e).then(function(e){t.tableData=[e.data.miner]})},refreshMinerTable:function(t){var e=this,a=this.$route.query.mac;this.$ajax.get("/v1/miner?mac="+a).then(function(a){e.tableData=[a.data.miner],t()})},switchTimeInterval:function(t){var e=this;this.$ajax.get("/v1/miner/mhs?period="+t+"&mac="+this.$route.query.mac).then(function(t){for(var a=t.data.miner_mhs,i=[],n=0;n<a.length;n++){var s=a[n];i.push([new Date(s.date).getTime(),s.mhs])}e.fakeDatas={day:i,week:i,month:i,season:i,half:i,year:i}})},fetchTemperautreList:function(){var t=this;this.$ajax.get("/v1/miner/temperature?period=day&mac="+this.$route.query.mac).then(function(e){for(var a=e.data.miner_temperature,i=[],n=0;n<a.length;n++){var s=a[n];i.push([new Date(s.date).getTime(),s.temperature])}t.temperatureList=i})}},created:function(){var t=this;this.fetchData(),this.timerInfo=setInterval(function(){t.fetchData()},5e3),this.switchTimeInterval("day"),setTimeout(function(){t.fetchTemperautreList()},1e3)},mounted:function(){},beforeDestroy:function(){clearInterval(this.timerInfo)}},Z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticClass:"mb",attrs:{type:"flex",justify:"space-between"}},[a("el-col",[a("div",{},[t._v("矿机状态: "),a("span",{domProps:{textContent:t._s(t.infoData.status)}})])]),t._v(" "),a("el-col",[a("div",{},[t._v("实时算力: "),a("span",{domProps:{textContent:t._s(t.infoData.curHashrate)}})])]),t._v(" "),a("el-col",[a("div",{},[t._v("平均算力: "),a("span",{domProps:{textContent:t._s(t.infoData.avgHashrate)}})])]),t._v(" "),a("el-col",[a("div",{},[t._v("运行时间: "),a("span",{domProps:{textContent:t._s(t.infoData.duration)}})])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"矿机信息"}},[a("miner-table",{attrs:{"table-data":t.tableData},on:{refresh:t.refreshMinerTable}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"算力板"}},[a("miner-board",{attrs:{"table-data":t.boardData}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"风扇"}},[a("miner-fan",{attrs:{"table-data":t.fanData}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"矿池"}},[a("miner-pool",{attrs:{"table-data":t.poolData},on:{refresh:t.refreshMinerTable}})],1),t._v(" "),a("el-tab-pane",{attrs:{label:"网络"}},[a("miner-network",{attrs:{"table-data":t.tableData},on:{refresh:t.refreshMinerTable}})],1)],1)],1),t._v(" "),a("el-row",{staticClass:"mb30 spline-wrap"},[a("hashrate-spline",{attrs:{hashrateList:t.fakeDatas,title:"矿机算力图表"},on:{switchTimeInterval:t.switchTimeInterval}})],1),t._v(" "),a("el-row",{staticClass:"mb30 spline-wrap"},[a("temperature-spline",{attrs:{temperatureList:t.temperatureList}})],1)],1)},staticRenderFns:[]};var tt=a("VU/8")(X,Z,!1,function(t){a("zG8i")},"data-v-cd299baa",null).exports,et={props:{visible:{type:Boolean,default:!1}},computed:{dialogVisible:{get:function(){return this.visible},set:function(){this.$emit("cancel")}}},data:function(){return{isEdit:!0,width:"1008px",pools:[{name:"pool1",addr:"",minerAddr:"",password:""},{name:"pool2",addr:"",minerAddr:"",password:""},{name:"pool3",addr:"",minerAddr:"",password:""}]}},methods:{cancel:function(){this.$emit("cancel")},save:function(){""!==this.pools[0].addr?""!==this.pools[0].minerAddr?this.$emit("save",this.pools):alert("pool1的矿工名不能为空!"):alert("pool1的矿池地址不能为空!")},empty:function(){this.pools.forEach(function(t){t.addr="",t.minerAddr="",t.password=""})}}},at={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,width:t.width},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.pools,stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),t._v(" "),a("el-table-column",{attrs:{width:"100",prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{domProps:{textContent:t._s(e.row.name)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"400",prop:"addr",label:"矿池地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿池地址",size:"small"},model:{value:e.row.addr,callback:function(a){t.$set(e.row,"addr","string"==typeof a?a.trim():a)},expression:"scope.row.addr"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",prop:"minerAddr",label:"矿工名"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入矿工名",size:"small"},model:{value:e.row.minerAddr,callback:function(a){t.$set(e.row,"minerAddr","string"==typeof a?a.trim():a)},expression:"scope.row.minerAddr"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"200",prop:"password",label:"密码"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{placeholder:"请输入密码",size:"small"},model:{value:e.row.password,callback:function(a){t.$set(e.row,"password","string"==typeof a?a.trim():a)},expression:"scope.row.password"}})]}}])})],1),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"15px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],on:{click:t.empty}},[t._v("清空")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)},staticRenderFns:[]},it={data:function(){return{startIP0:"192",startIP1:"168",startIP2:"0",startIP3:"0",endIP0:"192",endIP1:"168",endIP2:"0",endIP3:"0",ipList:[],checkedIps:[],checkAll:!1,isIndeterminate:!1,dialogBatchPoolsVisible:!1}},components:{BatchPoolsDialog:a("VU/8")(et,at,!1,null,null,null).exports},computed:{ips:function(){return this.startIP0+"."+this.startIP1+"."+this.startIP2+"."+this.startIP3+"~"+(this.endIP0+"."+this.endIP1+"."+this.endIP2+"."+this.endIP3)}},methods:{handleIpInput:function(t,e){var a=this;console.log(t),this.$nextTick(function(){var i=t.replace(/[^\d]/g,"");(i=i.replace(/\s+/g,"")).length>=2&&""===(i=i.replace(/^0+/,""))&&(i="0"),i.length>3&&(i=i.substr(0,3)),Number(i)>255&&(i="255"),a[e]=i})},handleIpChanged:function(t,e){""===t&&(this[e]="0")},addips:function(){this.ipList.includes(this.ips)||(this.ipList.push(this.ips),this.checkedIps.push(this.ips))},removeips:function(){var t=this.ipList.pop(),e=this.checkedIps.findIndex(function(e){return e===t});this.checkedIps.splice(e,1)},handleCheckAllChange:function(t){this.checkedIps=t?this.ipList:[],this.isIndeterminate=!1},handleCheckedIpsChange:function(t){var e=t.length;this.checkAll=e===this.ipList.length,this.isIndeterminate=e>0&&e<this.ipList.length},openDialogBatchPools:function(){0!==this.checkedIps.length?this.dialogBatchPoolsVisible=!0:alert("请添加 IP 范围")},closeDialogBatchPools:function(){this.dialogBatchPoolsVisible=!1},saveBatchPools:function(t){var e=this;this.$ajax.put("/v1/batch/pools",{ips:this.checkedIps,pools:t}).then(function(t){"success"===t.data.result?(alert("已发送批量配置矿池请求"),e.dialogBatchPoolsVisible=!1):alert("发送批量配置矿池请求失败")}).catch(function(t){alert(t)})}}},nt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"batch-container"},[a("el-row",{staticClass:"common-box",attrs:{type:"flex"}},[a("div",{staticClass:"batch-ip-range"},[a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex",align:"middle"}},[a("div",{staticClass:"mr"},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("IP范围:")])],1),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.addips}},[t._v("+")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:t.removeips}},[t._v("-")])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex"}},[a("div",[t._v("\n          起始IP:\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{change:function(e){t.handleIpChanged(e,"startIP0")},input:function(e){t.handleIpInput(e,"startIP0")}},model:{value:t.startIP0,callback:function(e){t.startIP0=e},expression:"startIP0"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"startIP1")}},model:{value:t.startIP1,callback:function(e){t.startIP1=e},expression:"startIP1"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"startIP2")}},model:{value:t.startIP2,callback:function(e){t.startIP2=e},expression:"startIP2"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"startIP3")}},model:{value:t.startIP3,callback:function(e){t.startIP3=e},expression:"startIP3"}})],1),t._v(" "),a("div",{staticStyle:{"margin-left":"20px"}},[t._v("\n          结束IP:\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"endIP0")}},model:{value:t.endIP0,callback:function(e){t.endIP0=e},expression:"endIP0"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"endIP1")}},model:{value:t.endIP1,callback:function(e){t.endIP1=e},expression:"endIP1"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"endIP2")}},model:{value:t.endIP2,callback:function(e){t.endIP2=e},expression:"endIP2"}}),t._v(" .\n          "),a("el-input",{staticClass:"input--ip",attrs:{size:"mini"},on:{input:function(e){t.handleIpInput(e,"endIP3")}},model:{value:t.endIP3,callback:function(e){t.endIP3=e},expression:"endIP3"}})],1)]),t._v(" "),a("el-checkbox-group",{staticClass:"batch-ip-range-list clearfix",on:{change:t.handleCheckedIpsChange},model:{value:t.checkedIps,callback:function(e){t.checkedIps=e},expression:"checkedIps"}},t._l(t.ipList,function(t,e){return a("div",{key:t+e,staticClass:"fl"},[a("el-checkbox",{attrs:{label:t}})],1)}))],1),t._v(" "),a("div",[a("div",{staticStyle:{"padding-left":"40px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.openDialogBatchPools}},[t._v("批量配置矿池")])],1)])]),t._v(" "),a("batch-pools-dialog",{attrs:{visible:t.dialogBatchPoolsVisible},on:{cancel:t.closeDialogBatchPools,save:t.saveBatchPools}})],1)},staticRenderFns:[]};var st=a("VU/8")(it,nt,!1,function(t){a("IzLJ")},null,null).exports;i.default.use(m.a);var rt=new m.a({routes:[{path:"/",name:"Home",component:N},{path:"/miner-detail",name:"MinerDtail",component:tt},{path:"/batch-configuration",name:"BatchConfiguration",component:st}]}),ot={minerStatus:{error:"异常",active:"正常"}},lt=a("mtWM"),ct=a.n(lt);function ut(t){return t<10?"0"+t:t}var pt={rate:1e3};var dt={pad0:ut,formatTime:function(t){var e=new Date(t);return e.getFullYear().toString()+"/"+ut(e.getMonth()+1)+"/"+ut(e.getDate())+" "+ut(e.getHours())+":"+ut(e.getMinutes())+":"+ut(e.getSeconds())},formatHashrate:function(t){var e=-1;do{t/=pt.rate,e++}while(t>pt.rate);var a=t.toFixed(2),i=["KH/S","MH/S","GH/S","TH/S","PH/S"][e];return{value:a,unit:i,text:a+" "+i,totalRate:Math.pow(pt.rate,e+1)}},formatDuration:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t<60)return t+"秒";var e=t%60,a=(t-e)/60;if(a<60)return a+"分"+e+"秒";var i=a%60,n=(a-i)/60;if(n<24)return n+"小时"+i+"分"+e+"秒";var s=n%24;return(n-s)/24+"天"+s+"小时"+i+"分"+e+"秒"},checkip:function(t){if(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(t)){var e=t.split(".");if(0===Number(e[0]))return!1;for(var a=0;a<e.length;a++)if(Number(e[a])>255)return!1;return!0}return!1}};i.default.config.productionTip=!1,i.default.use(s.a),i.default.prototype.$ajax=ct.a,ct.a.defaults.xsrfCookieName="csrfToken",ct.a.defaults.xsrfHeaderName="x-csrf-token",i.default.prototype.$util=dt,window.PublicKeys=ot,new i.default({el:"#app",router:rt,components:{App:h},template:"<App/>"})},Qbok:function(t,e){},"R+Ca":function(t,e){},agvb:function(t,e){},g7tb:function(t,e){},"ha/e":function(t,e){},oUCq:function(t,e){},"rpt/":function(t,e){},tn30:function(t,e){},tvR6:function(t,e){},xIhB:function(t,e){},zG8i:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6cad182a69ef35141b20.js.map